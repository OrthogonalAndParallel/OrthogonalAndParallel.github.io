import{_ as s,c as a,a as e,d as l,o as i,r as d}from"./app-DUomSOUZ.js";const r={};function c(p,t){const n=d("Mermaid");return i(),a("div",null,[t[0]||(t[0]=e('<h2 id="迭代" tabindex="-1"><a class="header-anchor" href="#迭代"><span>迭代</span></a></h2><table><thead><tr><th style="text-align:center;">日期</th><th style="text-align:center;">内容</th><th style="text-align:center;">云文档</th></tr></thead><tbody><tr><td style="text-align:center;">20250915</td><td style="text-align:center;">支持合并检验源单结果明细</td><td style="text-align:center;"><a href="https://docs.yonyoucloud.com/l/923856506a96?f=2321053129468280833" target="_blank" rel="noopener noreferrer">制造云-质量管理-检验单OpenAPI-合并检验.docx</a></td></tr></tbody></table><h2 id="实体关系" tabindex="-1"><a class="header-anchor" href="#实体关系"><span>实体关系</span></a></h2><img src="https://www.plantuml.com/plantuml/svg/dLLDQzj04BthLmWV0pdqMXB8DVVUnKgxf6fNij6k2e4UKgYT5kBQ45n2cvQOEYM4OALGS3x9dyckbN_HbMGxkv9MbdlJCE_DnvkPrHQX8A2XXmq70q9C_cllwVo0TGV6uijyQJfDYCpDPoVhJMRuU7Z6Hd_PwEEqtvdU7lAVn_peo_IsO-WS8jfhu4ECNkssafWPWd-zPdUzAf9BB4AR0TX92pcAMFytwqMiVSfk3fVKydZLZJz7JyFhwVUn0kKd4tvy4OylsVr0wV_nOSW_H8PiY19QRotN9otaKCkbo5i8CekSGmjXVGW2QBq3E4oBFjbd-nssTvT7peAcE0iuD0GOxpxBNIIy2U6EXtng1OY4c2OgTWUY2lPfnCRVijPB-YdHGL50Df86WDV2o9hFFdKcWy_1vf8isbnKdQMGvs78HkKcv80rfgzq9nk2RWEuBIP6jg6WopuNvg5-wDaeI67dV70vr-ccBoIUhuLaP6j1cc7W8Dl5M13ZQ28qu3zECnpl9bcgE9PToeg71u9O575sO2kUrlyUrP9p0ZQXWTXP1SVQ5wpznv2UaCQBXhcslcus_4RPYUKX9UTP1Lpb-Qd3LZfKRa_NHqt6yeRqroAZIj8LLDPkh2wTVg-g6Vh3stWlI5gPYj2LOzSQO74pYzbgWVG2LHQZFfWIL5c7BUH3yHl-1m00" alt=""><h2 id="api文档" tabindex="-1"><a class="header-anchor" href="#api文档"><span>API文档</span></a></h2><h3 id="保存" tabindex="-1"><a class="header-anchor" href="#保存"><span>保存</span></a></h3><h3 id="更新" tabindex="-1"><a class="header-anchor" href="#更新"><span>更新</span></a></h3><h3 id="全量保存" tabindex="-1"><a class="header-anchor" href="#全量保存"><span>全量保存</span></a></h3><table><thead><tr><th style="text-align:center;">名称</th><th style="text-align:center;">类型</th><th style="text-align:center;">描述</th><th style="text-align:center;">是否必填</th></tr></thead><tbody><tr><td style="text-align:center;">data</td><td style="text-align:center;">object</td><td style="text-align:center;">主数据对象</td><td style="text-align:center;">是</td></tr><tr><td style="text-align:center;">qms_qit_<br>incominspectorder<br>_sourcelistList</td><td style="text-align:center;">object</td><td style="text-align:center;">源单列表信息</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">sourceautoid</td><td style="text-align:center;">string</td><td style="text-align:center;">检验申请源单行id</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">qms_qit_<br>incominspectorder<br>_detailresultList</td><td style="text-align:center;">object</td><td style="text-align:center;">检验明细结果列表</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">handleType</td><td style="text-align:center;">string</td><td style="text-align:center;">处理方式id，id和类别不同时为空</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">handleTypeType</td><td style="text-align:center;">string</td><td style="text-align:center;">处理方式类别：<br>01-合格、02-挑选、03-改判、<br>04-拒收、05-让步接收、06-报废、<br>07-返工、08-返修、09-退货</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">nnum</td><td style="text-align:center;">number <br>小数位数:0,最大长度:28</td><td style="text-align:center;">数量</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">inspectResult</td><td style="text-align:center;">string</td><td style="text-align:center;">检验结果：1-合格、2-不合格。</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">isStorage</td><td style="text-align:center;">string</td><td style="text-align:center;">是否出可入库：0-否、1-是。</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">stockStatus</td><td style="text-align:center;">number <br>小数位数:0,最大长度:28</td><td style="text-align:center;">库存状态id，id和编码不同时为空</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">stockStatusCode</td><td style="text-align:center;">string</td><td style="text-align:center;">库存状态编码</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">inStockBatchCode</td><td style="text-align:center;">string</td><td style="text-align:center;">批次号</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">produceDate</td><td style="text-align:center;">date 格式:<br>yyyy-MM-dd HH:mm:ss</td><td style="text-align:center;">生产日期</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">validityDate</td><td style="text-align:center;">date 格式:<br>yyyy-MM-dd HH:mm:ss</td><td style="text-align:center;">有效期</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">destroySimpleResult</td><td style="text-align:center;">number <br>小数位数:0,最大长度:28</td><td style="text-align:center;">是否破坏性样本处理结果：0-否、1-是</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">baditemFlag</td><td style="text-align:center;">string</td><td style="text-align:center;">不良品处理：1-是、0-否</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">freect_b</td><td style="text-align:center;">特征组 <br>QMSQIT.incominspectorder.<br>qms_qit_incominspectorder_detailresult</td><td style="text-align:center;">判定物料自由项特征组：<br>成本敏感的自由项特征组不可修改，处理方式≠改判时，<br>仅可更新特征值为空的特征；处理方式=改判时，<br>可更新除成本敏感外的特征值。</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">qualityGrade</td><td style="text-align:center;">number <br>小数位数:8,最大长度:28</td><td style="text-align:center;">质量计分</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">qualifyGrade</td><td style="text-align:center;">string</td><td style="text-align:center;">质量等级</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">badReasonId</td><td style="text-align:center;">string</td><td style="text-align:center;">不良原因id</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">scrapProcessCode</td><td style="text-align:center;">string</td><td style="text-align:center;">责任工序编码</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">reworkProcessCode</td><td style="text-align:center;">string</td><td style="text-align:center;">建议返工工序编码</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">scrapLeaderId</td><td style="text-align:center;">string</td><td style="text-align:center;">责任人id，id和编码不同时为空</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">scrapLeaderCode</td><td style="text-align:center;">string</td><td style="text-align:center;">责任人编码</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">note</td><td style="text-align:center;">string</td><td style="text-align:center;">备注</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">definect_d</td><td style="text-align:center;">特征组 <br>QMSQIT.incominspectorder.<br>qms_qit_incominspectorder_detailresult</td><td style="text-align:center;">自定义项特征组</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">qms_qit_detailresult<br>_bad_itemsList</td><td style="text-align:center;">object</td><td style="text-align:center;">处理结果明细不良项目孙表</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">badItemsCode</td><td style="text-align:center;">string</td><td style="text-align:center;">不良项目编码</td><td style="text-align:center;">否</td></tr><tr><td style="text-align:center;">number</td><td style="text-align:center;">number <br>小数位数:0,最大长度:28</td><td style="text-align:center;">不良个数</td><td style="text-align:center;">否</td></tr></tbody></table><h3 id="补填" tabindex="-1"><a class="header-anchor" href="#补填"><span>补填</span></a></h3><h2 id="类图" tabindex="-1"><a class="header-anchor" href="#类图"><span>类图</span></a></h2>',11)),l(n,{id:"mermaid-479",code:"eJy1lD1Lw0AYx+f0U9zYgh0Ex1Bom8EM0mLA/Zo81NMkF+6uXaqbLzgUXRRB3BxclA7ufhkT8Vt4TaLE9HqtkGbJC/f/PW//J66PObcIHjIc1Iz0Ddkhj8AVPeYB60UQtvu2g8fgABsTFyY1wzDN9GSrVUP5tYcj0xGMhMMt1BscSXkLkZADE/UO8X0LC2wJigbyuYHQx/tj/HKvFY8iDwtQiJOHt+Rutkbgg21V6Pj8+evyupTAmBIvV/UZ7OLQ81WhM1V8NU1uZ8n0NX46+7y5+AvJ0tZBsvy1kJ/8dZhiHWWYcZrysml2aRDQMJ/pPvCRL2ukLnBOGZr8Bl4caZpKlB2tN9LPRe7GiA4dMVe2sOoc5/3rHoJ7DFUwLRCY+JvqZwd7toCgEnA7InYQUSbmTpB2yvdYi8w2CXG5Vj7Ml39HUhZdmMdKb/q/BjKbzSWW+ae6ZI911Uu6UJSXjVcIqpx2UbtosbXU2uU0TypFrMxeWbnaj0WxehNWI74BwaY8mA=="}),t[1]||(t[1]=e(`<ul><li>InspectOrderOpenAPISaveService</li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span></span></span>
<span class="line"><span>insertPreHandle (BillDataDto bill) {</span></span>
<span class="line"><span>    - 获取检验申请</span></span>
<span class="line"><span>    - 检验申请转检验单</span></span>
<span class="line"><span>    - 补充数据</span></span>
<span class="line"><span>    - 处理表头扩展表</span></span>
<span class="line"><span>    - 设置单据编码</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>updatePreHandle (BillDataDto bill) {</span></span>
<span class="line"><span>    - 设置单据编码</span></span>
<span class="line"><span>    - 补充数据</span></span>
<span class="line"><span>    - 处理检验信息</span></span>
<span class="line"><span>    - 处理表头样本信息</span></span>
<span class="line"><span>    - 处理处理结果信息</span></span>
<span class="line"><span>    + 处理源单信息信息</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>insertV1PreHandle (BillDataDto bill) {</span></span>
<span class="line"><span>    - 获取检验申请</span></span>
<span class="line"><span>    - 检验申请转检验单</span></span>
<span class="line"><span>    - 补充数据</span></span>
<span class="line"><span>    - 处理表头扩展表</span></span>
<span class="line"><span>    - 处理检验信息</span></span>
<span class="line"><span>    - 处理表头样本信息</span></span>
<span class="line"><span>    - 处理处理结果信息</span></span>
<span class="line"><span>    + 处理源单信息信息</span></span>
<span class="line"><span>    - 设置单据编码</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>InspectSourceProcessor</li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>process (BillDataDto bill) {</span></span>
<span class="line"><span>    + 匹配转单和openApi传入的sourceautoid</span></span>
<span class="line"><span>    + 匹配上处理当前处理结果明细孙表</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>InspectResultProcessor</li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>process () {</span></span>
<span class="line"><span>    + 判断是否触发了整单判定 InspectResultDataChecker.addCheckStatus</span></span>
<span class="line"><span>    + 触发整单判定，验证传入的数量和整单数量比对，触发检验完成 InspectResultDataChecker.validateResultSum</span></span>
<span class="line"><span>    + 拷贝一条默认生成的处理结果明细作模版</span></span>
<span class="line"><span>    for (Map&lt;String, Object&gt; detailResultMap : detailResultMaps) {</span></span>
<span class="line"><span>        + 拷贝模版作为新增的处理结果明细行</span></span>
<span class="line"><span>        + 补充传入的处理结果公共字段 CommonInspectResultProcessor.addResultField()</span></span>
<span class="line"><span>        + 补充表头id、源单ID、单据状态</span></span>
<span class="line"><span>        + 处理不良项目孙表 inspectResultBadItemDataProcessor.process()</span></span>
<span class="line"><span>    }    </span></span>
<span class="line"><span>    + 汇总表头合格数、不合格数、破坏数、破坏管理方式、破坏承担方 CommonInspectResultProcessor.addResultSum()</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>CommonInspectResultProcessor</li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>addResultField () {</span></span>
<span class="line"><span>    + 添加处理方式</span></span>
<span class="line"><span>    + 添加库存状态</span></span>
<span class="line"><span>    + 添加是否入库</span></span>
<span class="line"><span>    + 校验检验结果入参合法性</span></span>
<span class="line"><span>    + 添加检验结果</span></span>
<span class="line"><span>    + 添加数量、件数</span></span>
<span class="line"><span>    + ...</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>addResultSum() {</span></span>
<span class="line"><span>    ...</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>InspectResultDataChecker</li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>process () {</span></span>
<span class="line"><span>    + 判断是否触发了整单判定 addCheckStatus()</span></span>
<span class="line"><span>    + 校验处理结果数量和整单是否匹配 validateResultSum()</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>InspectResultBadItemProcessor</li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>process () {</span></span>
<span class="line"><span>    + 将传入不良项目信息新增到结果明细孙表？平台是否支持重孙表</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,12))])}const u=s(r,[["render",c],["__file","index.html.vue"]]),v=JSON.parse('{"path":"/%E7%94%A8%E5%8F%8B/20250915-%E6%A3%80%E9%AA%8C%E5%8D%95OpenAPI/","title":"20250915-检验单OpenAPI","lang":"zh-CN","frontmatter":{"title":"20250915-检验单OpenAPI","createTime":"2025/07/22 13:30:44","permalink":"/用友/20250915-检验单OpenAPI/","description":"迭代 实体关系 API文档 保存 更新 全量保存 补填 类图 InspectOrderOpenAPISaveService InspectSourceProcessor InspectResultProcessor CommonInspectResultProcessor InspectResultDataChecker InspectResultBa...","head":[["meta",{"property":"og:url","content":"https://orthogonalandparallel.github.io/%E7%94%A8%E5%8F%8B/20250915-%E6%A3%80%E9%AA%8C%E5%8D%95OpenAPI/"}],["meta",{"property":"og:site_name","content":"万里任禅游"}],["meta",{"property":"og:title","content":"20250915-检验单OpenAPI"}],["meta",{"property":"og:description","content":"迭代 实体关系 API文档 保存 更新 全量保存 补填 类图 InspectOrderOpenAPISaveService InspectSourceProcessor InspectResultProcessor CommonInspectResultProcessor InspectResultDataChecker InspectResultBa..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-09-19T03:44:41.000Z"}],["meta",{"property":"article:modified_time","content":"2025-09-19T03:44:41.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"20250915-检验单OpenAPI\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-09-19T03:44:41.000Z\\",\\"author\\":[]}"]]},"headers":[],"readingTime":{"minutes":5.37,"words":1611},"git":{"updatedTime":1758253481000,"contributors":[{"name":"靳琛","email":"jinchenj@yonyou.com","commits":7,"avatar":"https://avatars.githubusercontent.com/靳琛?v=4","url":"https://github.com/靳琛"}]},"autoDesc":true,"filePathRelative":"笔记/用友/BIP/制造云/质量管理/设计/20250915-检验单OpenAPI.md","categoryList":[{"id":"7051dc","sort":10000,"name":"笔记"},{"id":"01ffd5","sort":10001,"name":"用友"},{"id":"b4ff1c","sort":10002,"name":"BIP"},{"id":"86a043","sort":10006,"name":"制造云"},{"id":"a13c9f","sort":10008,"name":"质量管理"},{"id":"c01821","sort":10016,"name":"设计"}],"bulletin":false}');export{u as comp,v as data};
